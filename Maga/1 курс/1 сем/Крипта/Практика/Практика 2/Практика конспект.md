 # Диффи-Хелман 
 протокол для выработки общего ключа
 обмен инфы по откр каналам 

Группа G
1. $Ɐ$ a,b,c $∈$ G: $(a*b)*c=a*(b*c)$
2.  $Ǝ$e $∈$ G, a $∈$ G: $e*a =a*e=a$
3. $Ɐ$ a $∈$ G, $Ǝa`i$ $a*a`=a`*a=e$

Порядок группы - число элементов.
$Ǝ$g $∈$ G: {$g, g^{2}, ..., g^{n}$} = G
Группа называетстя циклической если есть пораждающий элемент (при возведении 
в степень самого на себя получаем все элементы этого множества)

$Z^{7}={1,2,3,4,5,6}$
Как найти пораждающий элемент:
1. Перебор 
   $3^{1}mod7=3$
   $3^{2}mod7=2$
   $3^{3}mod7=6$
   $3^{4}mod7=4$
   $3^{5}mod7=5$
   $3^{6}mod7=1$
 ```mermaid
 sequenceDiagram
  A->>+B: A
  B->>+A: B
  Note right of B: b<N, B=$g^{b}modN$
  Note left of A: a<N, A=$g^{a}modN$ 
  
```
Алгоритм:
 1. выбираем любое большое простое число N
 2. теперь выбраем g малое, которое является пораждающим элементом группы Z(N) 
 3. A выбирает рандомно а
 4. B выбирает рандомно b
 5. A=$g^{a}modN$ 
 6. B=$g^{b}modN$ 
 7. Kab=$B^{a}modN=g^{ab}modN$
 8. Kba=$A^{b}modN=g^{ba}modN$
 9. Kab=Kba

 # Малая теорема ферма
Сравнимость - $m∈N, m<>0$, a,b∈Z modm
7≡3mod4
7-3=4
4|4
Свойства сравнимости
1. a≡amod(n)
2. если, a≡b,  то b≡a mod(n)
3. если, a≡bmod(n) и b≡cmod(n) -> a≡cmod(n)
4. если, $a_1≡a_2mod(n)$ и $b_1≡b_2mod(n)$
$a_1+b_1≡a_2+b_2mod(n)$
a⊥n, n-простое число
$a^{n-1}≡2modn$
пример
$10^{10}≡1mod11$
$100^{5}≡1mod11$
$(1+99)^{5}≡1mod11$
$(1)^{5}≡1mod11$
$1≡1mod11$

# Функция Эйлера 
1. f(p)=p-1
2. f(p\*q)=(p-1)(q-1)
3. f($p^{n}$)=($p^{n}$-$p^{n-1}$)

# Теорема Эйлера
a⊥m, m-prime
$a^{f(m)}≡1modm$

# Китайская теорема об остатках
$M=r_1mod(n_1)$
$M=r_2mod(n_2)$
$M=r_3mod(n_3)$
...
$M=r_kmod(n_k)$
1. $N=n_1*n_1*n_k$
2. $M_N*n_1≡1mod(n_1)$
    $M_2*N_2≡1mod(n_2)$
    $M_k*N_k≡1mod(n_k)$
$M=r_1*M_1*N_1+r_2*M_2*N_2+...++r_k*N_k*M_k mod(N)$
$Mmod(n_1)=r_1*N_1*M_1=r_1mod(n_1)$

$M_1=7mod(9)$
$M_2=13mod(8)$
$M_3=5mod(11)$

$N=9*8*11=792$
$N_1=\frac{792}{9}=88$
$N_2=\frac{792}{8}=99$
$N_3=\frac{792}{11}=72$

$M_1$|$M_2$|$M_3$
---|---|---
$M_1*88≡1mod(9)$|$M_2*99≡1mod(8)$|$M_3*72≡1mod(11)$
$M_1*7≡1mod(9)$|$M_2*3≡1mod(8)$|$M_3*6≡1mod(11)$
$28≡1mod(9)$|$9≡1mod(8)$|$2*6≡1mod(11)$
$M_1=4$|$M_2=3$|$M_3=2$
$M=7*4*88+5*99*3+5*72*6mod(792)=565$


# Задание по командам (4 команды). Криптосистема Рабина
## Генерация ключей
1. p-prime, p≡3mod(4)
    q-prime, p≡3mod(4)
    PubKey{N=pq}
    SecKey{p,q}
	
## Шифрование
$c=m^{2}mod(N)

## Дешифрование
1. $m_p=c^{\frac{1}{4}(p+3)}mod(p)$
    $m_q=c^{\frac{1}{4}(q+3)}mod(q)$
2. $y_p*p≡1mod(q)$
    $y_q*q≡1mod(p)$
3. $r_1-y_p*p*m_q+y_q*q*m_pmod(N)$ 
    $r_2=N-r_1$
    $r_3-y_p*p*m_q-y_q*q*m_pmod(N)$
    $r_4=N-r_3$


